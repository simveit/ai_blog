<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>A first ü§ó model | fastpages</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="A first ü§ó model" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An easy to use blogging platform with support for Jupyter Notebooks." />
<meta property="og:description" content="An easy to use blogging platform with support for Jupyter Notebooks." />
<link rel="canonical" href="https://simveit.github.io/ai_blog/2022/09/05/First-try-with-Hugging-Face.html" />
<meta property="og:url" content="https://simveit.github.io/ai_blog/2022/09/05/First-try-with-Hugging-Face.html" />
<meta property="og:site_name" content="fastpages" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-09-05T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="A first ü§ó model" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-09-05T00:00:00-05:00","datePublished":"2022-09-05T00:00:00-05:00","description":"An easy to use blogging platform with support for Jupyter Notebooks.","headline":"A first ü§ó model","mainEntityOfPage":{"@type":"WebPage","@id":"https://simveit.github.io/ai_blog/2022/09/05/First-try-with-Hugging-Face.html"},"url":"https://simveit.github.io/ai_blog/2022/09/05/First-try-with-Hugging-Face.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/ai_blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://simveit.github.io/ai_blog/feed.xml" title="fastpages" /><link rel="shortcut icon" type="image/x-icon" href="/ai_blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/ai_blog/">fastpages</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/ai_blog/about/">About Me</a><a class="page-link" href="/ai_blog/search/">Search</a><a class="page-link" href="/ai_blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">A first ü§ó model</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-09-05T00:00:00-05:00" itemprop="datePublished">
        Sep 5, 2022
      </time>
       ‚Ä¢ <span class="read-time" title="Estimated read time">
    
    
      16 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/simveit/ai_blog/tree/master/_notebooks/2022-09-05-First-try-with-ü§ó-Hugging-Face.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/ai_blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/simveit/ai_blog/master?filepath=_notebooks%2F2022-09-05-First-try-with-%F0%9F%A4%97-Hugging-Face.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/ai_blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/simveit/ai_blog/blob/master/_notebooks/2022-09-05-First-try-with-ü§ó-Hugging-Face.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/ai_blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Fsimveit%2Fai_blog%2Fblob%2Fmaster%2F_notebooks%2F2022-09-05-First-try-with-%F0%9F%A4%97-Hugging-Face.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/ai_blog/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-09-05-First-try-with-ü§ó-Hugging-Face.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As <a href="https://course.fast.ai/Lessons/lesson4.html">Lesson 4</a> of the fastai DL course deals with NLP, I decided to give this <a href="https://www.kaggle.com/competitions/feedback-prize-english-language-learning">competition</a> on kaggle a try.</p>
<p>Many hints to how implement multi label classification can be found in <a href="https://github.com/NielsRogge/Transformers-Tutorials/blob/master/BERT/Fine_tuning_BERT_(and_friends">the following great notebook</a>_for_multi_label_text_classification.ipynb)</p>
<p>This is my first NLP model, so please make sure I didn't make any mistakes and if so, pls let me know üòÄ</p>
<p>Have fun reading ‚ò∫Ô∏è</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">Dataset</span><span class="p">,</span><span class="n">DatasetDict</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AutoModelForSequenceClassification</span><span class="p">,</span><span class="n">AutoTokenizer</span>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="c1"># Set nice style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">([</span><span class="s1">&#39;dark_background&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A-first-look-at-our-data">A first look at our data<a class="anchor-link" href="#A-first-look-at-our-data"> </a></h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;feedback-prize-english-language-learning&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Get an overview of what is contained in our folder.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>ls <span class="o">{</span>path<span class="o">}</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>sample_submission.csv  test.csv  train.csv
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_ss</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s2">&quot;sample_submission.csv&quot;</span><span class="p">)</span>
<span class="n">df_tst</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s2">&quot;test.csv&quot;</span><span class="p">)</span>
<span class="n">df_trn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s2">&quot;train.csv&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From <a href="https://www.kaggle.com/competitions/feedback-prize-english-language-learning/data">the competition site</a> we know that we have six different categories which determine the proficiency in essay writing of a given student. Higher scores -&gt; Higher proficiency.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_ss</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text_id</th>
      <th>cohesion</th>
      <th>syntax</th>
      <th>vocabulary</th>
      <th>phraseology</th>
      <th>grammar</th>
      <th>conventions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0000C359D63E</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>000BAD50D026</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>00367BB2546B</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's look at example of a training data.</p>
<p>We have for each text_id a text and the corresponding grades:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_trn</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>text_id</th>
      <td>0016926B079C</td>
    </tr>
    <tr>
      <th>full_text</th>
      <td>I think that students would benefit from learn...</td>
    </tr>
    <tr>
      <th>cohesion</th>
      <td>3.5</td>
    </tr>
    <tr>
      <th>syntax</th>
      <td>3.5</td>
    </tr>
    <tr>
      <th>vocabulary</th>
      <td>3.0</td>
    </tr>
    <tr>
      <th>phraseology</th>
      <td>3.0</td>
    </tr>
    <tr>
      <th>grammar</th>
      <td>4.0</td>
    </tr>
    <tr>
      <th>conventions</th>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Example of a text:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_trn</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">full_text</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#34;I think that students would benefit from learning at home,because they wont have to change and get up early in the morning to shower and do there hair. taking only classes helps them because at there house they&#39;ll be pay more attention. they will be comfortable at home.\n\nThe hardest part of school is getting ready. you wake up go brush your teeth and go to your closet and look at your cloths. after you think you picked a outfit u go look in the mirror and youll either not like it or you look and see a stain. Then you&#39;ll have to change. with the online classes you can wear anything and stay home and you wont need to stress about what to wear.\n\nmost students usually take showers before school. they either take it before they sleep or when they wake up. some students do both to smell good. that causes them do miss the bus and effects on there lesson time cause they come late to school. when u have online classes u wont need to miss lessons cause you can get everything set up and go take a shower and when u get out your ready to go.\n\nwhen your home your comfortable and you pay attention. it gives then an advantage to be smarter and even pass there classmates on class work. public schools are difficult even if you try. some teacher dont know how to teach it in then way that students understand it. that causes students to fail and they may repeat the class.              &#34;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's look at the distribution of the grades:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's take a look of the distribution of grades:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="n">df_trn</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
<span class="n">nrow</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">ncol</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrow</span><span class="p">,</span> <span class="n">ncol</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_trn</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">8</span><span class="p">);</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that there are many medium grades with just a few outliers on the left spectrum.</p>
<p>We should probably take this into account when building our training and validation set so that our model is also able to grade a bad student.</p>
<p>Let's look at the rough numbers summarized in a pretty looking data frame:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_trn</span><span class="p">[</span><span class="n">labels</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">value_counts</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cohesion</th>
      <th>syntax</th>
      <th>vocabulary</th>
      <th>phraseology</th>
      <th>grammar</th>
      <th>conventions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1.0</th>
      <td>10</td>
      <td>11</td>
      <td>2</td>
      <td>10</td>
      <td>8</td>
      <td>15</td>
    </tr>
    <tr>
      <th>1.5</th>
      <td>27</td>
      <td>29</td>
      <td>14</td>
      <td>11</td>
      <td>20</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2.0</th>
      <td>315</td>
      <td>410</td>
      <td>124</td>
      <td>350</td>
      <td>544</td>
      <td>402</td>
    </tr>
    <tr>
      <th>2.5</th>
      <td>790</td>
      <td>839</td>
      <td>528</td>
      <td>772</td>
      <td>855</td>
      <td>784</td>
    </tr>
    <tr>
      <th>3.0</th>
      <td>1096</td>
      <td>1250</td>
      <td>1503</td>
      <td>1153</td>
      <td>994</td>
      <td>1151</td>
    </tr>
    <tr>
      <th>3.5</th>
      <td>988</td>
      <td>867</td>
      <td>1007</td>
      <td>929</td>
      <td>880</td>
      <td>908</td>
    </tr>
    <tr>
      <th>4.0</th>
      <td>534</td>
      <td>388</td>
      <td>577</td>
      <td>553</td>
      <td>447</td>
      <td>484</td>
    </tr>
    <tr>
      <th>4.5</th>
      <td>125</td>
      <td>100</td>
      <td>115</td>
      <td>108</td>
      <td>134</td>
      <td>122</td>
    </tr>
    <tr>
      <th>5.0</th>
      <td>26</td>
      <td>17</td>
      <td>41</td>
      <td>25</td>
      <td>29</td>
      <td>25</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Especially of the vocabulary and phraseology we should take care that we sample enough examples from the $\leq 1.0$ range.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Another point of interest is the words contained in our texts. Let's check that we don't have extreme outliers as Transformers don't work good for long text inputs:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_trn</span><span class="p">[</span><span class="s2">&quot;full_text&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span><span class="o">.</span><span class="n">hist</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We see that most texts are made of 200-600 words.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Preprocess">Preprocess<a class="anchor-link" href="#Preprocess"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To use the transformers we need a dataset.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df_trn</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Dataset({
    features: [&#39;text_id&#39;, &#39;full_text&#39;, &#39;cohesion&#39;, &#39;syntax&#39;, &#39;vocabulary&#39;, &#39;phraseology&#39;, &#39;grammar&#39;, &#39;conventions&#39;],
    num_rows: 3911
})</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>What exactly is a dataset?</p>
<p>Let's explore.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have an Attribut <code>column_name</code></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">column_names</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;text_id&#39;,
 &#39;full_text&#39;,
 &#39;cohesion&#39;,
 &#39;syntax&#39;,
 &#39;vocabulary&#39;,
 &#39;phraseology&#39;,
 &#39;grammar&#39;,
 &#39;conventions&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With <code>ds[i]</code>we can get the i'th element</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;text_id&#39;: &#39;0016926B079C&#39;,
 &#39;full_text&#39;: &#34;I think that students would benefit from learning at home,because they wont have to change and get up early in the morning to shower and do there hair. taking only classes helps them because at there house they&#39;ll be pay more attention. they will be comfortable at home.\n\nThe hardest part of school is getting ready. you wake up go brush your teeth and go to your closet and look at your cloths. after you think you picked a outfit u go look in the mirror and youll either not like it or you look and see a stain. Then you&#39;ll have to change. with the online classes you can wear anything and stay home and you wont need to stress about what to wear.\n\nmost students usually take showers before school. they either take it before they sleep or when they wake up. some students do both to smell good. that causes them do miss the bus and effects on there lesson time cause they come late to school. when u have online classes u wont need to miss lessons cause you can get everything set up and go take a shower and when u get out your ready to go.\n\nwhen your home your comfortable and you pay attention. it gives then an advantage to be smarter and even pass there classmates on class work. public schools are difficult even if you try. some teacher dont know how to teach it in then way that students understand it. that causes students to fail and they may repeat the class.              &#34;,
 &#39;cohesion&#39;: 3.5,
 &#39;syntax&#39;: 3.5,
 &#39;vocabulary&#39;: 3.0,
 &#39;phraseology&#39;: 3.0,
 &#39;grammar&#39;: 4.0,
 &#39;conventions&#39;: 3.0}</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's initialize our tokenizer:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_nm</span> <span class="o">=</span> <span class="s1">&#39;microsoft/deberta-v3-small&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tokz</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">model_nm</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
/usr/local/lib/python3.9/dist-packages/transformers/convert_slow_tokenizer.py:434: UserWarning: The sentencepiece tokenizer that you are converting to a fast tokenizer uses the byte fallback option which is not implemented in the fast tokenizers. In practice this means that the fast version of the tokenizer can produce unknown tokens whereas the sentencepiece version would have converted these unknown tokens into a sequence of byte tokens matching the original piece of text.
  warnings.warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's see how exactly this works:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tokz</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="s2">&quot;I want to get tokenized!&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;‚ñÅI&#39;, &#39;‚ñÅwant&#39;, &#39;‚ñÅto&#39;, &#39;‚ñÅget&#39;, &#39;‚ñÅtoken&#39;, &#39;ized&#39;, &#39;!&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can encode...</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">enc</span> <span class="o">=</span> <span class="n">tokz</span><span class="o">.</span><span class="n">encode</span><span class="p">((</span><span class="s2">&quot;I want to get tokenized!&quot;</span><span class="p">))</span>
<span class="n">enc</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[1, 273, 409, 264, 350, 10704, 4666, 300, 2]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>... and decode</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tokz</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">enc</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;[CLS] I want to get tokenized![SEP]&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we need to do 2 things:</p>
<ul>
<li>tokenize our data, that means transforming the text into some form the computer can process</li>
<li>initialize our multi label for the model.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's first tackle the problem of generating categories:</p>
<ul>
<li>We One hot encode</li>
<li>We use the resulting df to generate our dataset!</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tempdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df_trn</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">tempdf</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Split in training and validation!</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds_d</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Mapping between labels and integers</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ds_d</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;text_id&#39;</span><span class="p">,</span> <span class="s1">&#39;full_text&#39;</span><span class="p">]]</span>
<span class="n">id2label</span> <span class="o">=</span> <span class="p">{</span><span class="n">idx</span><span class="p">:</span><span class="n">label</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">)}</span>
<span class="n">label2id</span> <span class="o">=</span> <span class="p">{</span><span class="n">label</span><span class="p">:</span><span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">)}</span>
<span class="n">labels</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;cohesion_1.0&#39;,
 &#39;cohesion_1.5&#39;,
 &#39;cohesion_2.0&#39;,
 &#39;cohesion_2.5&#39;,
 &#39;cohesion_3.0&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">preprocess_data</span><span class="p">(</span><span class="n">examples</span><span class="p">):</span>
    <span class="c1"># take a batch of texts</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">examples</span><span class="p">[</span><span class="s2">&quot;full_text&quot;</span><span class="p">]</span>
    <span class="c1"># encode them</span>
    <span class="n">encoding</span> <span class="o">=</span> <span class="n">tokz</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;max_length&quot;</span><span class="p">,</span> <span class="n">truncation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
    <span class="c1"># add labels</span>
    <span class="n">labels_batch</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">examples</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">examples</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">}</span>
    <span class="c1"># create numpy array of shape (batch_size, num_labels)</span>
    <span class="n">labels_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)))</span>
    <span class="c1"># fill numpy array</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
        <span class="n">labels_matrix</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels_batch</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>

    <span class="n">encoding</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels_matrix</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
  
    <span class="k">return</span> <span class="n">encoding</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">enc_ds_d</span> <span class="o">=</span> <span class="n">ds_d</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">preprocess_data</span><span class="p">,</span> <span class="n">batched</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_columns</span><span class="o">=</span><span class="n">ds_d</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">column_names</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Parameter &#39;function&#39;=&lt;function preprocess_data at 0x7fac4afecc10&gt; of the transform datasets.arrow_dataset.Dataset._map_single couldn&#39;t be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won&#39;t be showed.
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">enc_ds_d</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>DatasetDict({
    train: Dataset({
        features: [&#39;input_ids&#39;, &#39;token_type_ids&#39;, &#39;attention_mask&#39;, &#39;labels&#39;],
        num_rows: 2933
    })
    test: Dataset({
        features: [&#39;input_ids&#39;, &#39;token_type_ids&#39;, &#39;attention_mask&#39;, &#39;labels&#39;],
        num_rows: 978
    })
})</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Split in train and validation set</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Training">Training<a class="anchor-link" href="#Training"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Setting up the metric...</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mcrmse</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span> <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mcrmse</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.5</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mcrmse_d</span><span class="p">(</span><span class="n">eval_pred</span><span class="p">):</span> <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;mcrmse&#39;</span><span class="p">:</span> <span class="n">mcrmse</span><span class="p">(</span><span class="o">*</span><span class="n">eval_pred</span><span class="p">)}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">TrainingArguments</span><span class="p">,</span><span class="n">Trainer</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>...Batch size and metric name...</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">metric_name</span> <span class="o">=</span> <span class="s2">&quot;mcrmse&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>...the arguments...</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">args</span> <span class="o">=</span> <span class="n">TrainingArguments</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;outputs&quot;</span><span class="p">,</span>
    <span class="n">evaluation_strategy</span> <span class="o">=</span> <span class="s2">&quot;epoch&quot;</span><span class="p">,</span>
    <span class="n">save_strategy</span> <span class="o">=</span> <span class="s2">&quot;epoch&quot;</span><span class="p">,</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">8e-5</span><span class="p">,</span>
    <span class="n">per_device_train_batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
    <span class="n">per_device_eval_batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
    <span class="n">num_train_epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">weight_decay</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="n">load_best_model_at_end</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">metric_for_best_model</span><span class="o">=</span><span class="n">metric_name</span><span class="p">,</span>
    <span class="c1">#push_to_hub=True,</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">EvalPrediction</span>
<span class="kn">import</span> <span class="nn">torch</span>
    
<span class="c1"># source: https://jesusleal.io/2021/04/21/Longformer-multilabel-classification/</span>
<span class="k">def</span> <span class="nf">multi_label_metrics</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="c1"># first, apply sigmoid on predictions which are of shape (batch_size, num_labels)</span>
    <span class="n">sigmoid</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Sigmoid</span><span class="p">()</span>
    <span class="n">probs</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">predictions</span><span class="p">))</span>
    <span class="c1"># next, use threshold to turn them into integer predictions</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">probs</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">y_pred</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">probs</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="c1"># finally, compute metrics</span>
    <span class="n">y_true</span> <span class="o">=</span> <span class="n">labels</span>
    <span class="n">mcrmse_acc</span> <span class="o">=</span> <span class="n">mcrmse</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="c1"># return as dictionary</span>
    <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;mcrmse&#39;</span><span class="p">:</span> <span class="n">mcrmse_acc</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">metrics</span>

<span class="k">def</span> <span class="nf">compute_metrics</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n">EvalPrediction</span><span class="p">):</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">predictions</span><span class="p">,</span> 
            <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="n">p</span><span class="o">.</span><span class="n">predictions</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">multi_label_metrics</span><span class="p">(</span>
        <span class="n">predictions</span><span class="o">=</span><span class="n">preds</span><span class="p">,</span> 
        <span class="n">labels</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">label_ids</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>...the model...</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AutoModelForSequenceClassification</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">AutoModelForSequenceClassification</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">model_nm</span><span class="p">,</span> 
                                                           <span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;multi_label_classification&quot;</span><span class="p">,</span> 
                                                           <span class="n">num_labels</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span>
                                                           <span class="n">id2label</span><span class="o">=</span><span class="n">id2label</span><span class="p">,</span>
                                                           <span class="n">label2id</span><span class="o">=</span><span class="n">label2id</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Some weights of the model checkpoint at microsoft/deberta-v3-small were not used when initializing DebertaV2ForSequenceClassification: [&#39;mask_predictions.dense.bias&#39;, &#39;mask_predictions.LayerNorm.weight&#39;, &#39;mask_predictions.classifier.bias&#39;, &#39;lm_predictions.lm_head.bias&#39;, &#39;lm_predictions.lm_head.dense.bias&#39;, &#39;mask_predictions.dense.weight&#39;, &#39;lm_predictions.lm_head.LayerNorm.weight&#39;, &#39;lm_predictions.lm_head.dense.weight&#39;, &#39;lm_predictions.lm_head.LayerNorm.bias&#39;, &#39;mask_predictions.classifier.weight&#39;, &#39;mask_predictions.LayerNorm.bias&#39;]
- This IS expected if you are initializing DebertaV2ForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing DebertaV2ForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of DebertaV2ForSequenceClassification were not initialized from the model checkpoint at microsoft/deberta-v3-small and are newly initialized: [&#39;classifier.weight&#39;, &#39;pooler.dense.bias&#39;, &#39;pooler.dense.weight&#39;, &#39;classifier.bias&#39;]
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="TRAIN!">TRAIN!<a class="anchor-link" href="#TRAIN!"> </a></h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">enc_ds_d</span><span class="o">.</span><span class="n">set_format</span><span class="p">(</span><span class="s2">&quot;torch&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's verify a batch as well as a forward pass:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">enc_ds_d</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;torch.FloatTensor&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">enc_ds_d</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">][</span><span class="s1">&#39;input_ids&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([    1,  4136,   269,   311,   265,   262,   370,   874,   470,   267,
          291,   447,   260,  4136,   303,  1738,   265,  1451,   261,   306,
          286,   610,  6135,  4986,   334,  2858,  8202,   261,  7934,   261,
        13381,   795,  8202,   261,   263,   386,   310,   260,   450,   286,
          610, 34772,   272,   783,   360,   803,   261,   528,   355,   261,
          306,   402,   286,   347,  1085,   830,   334,   306,   286,   286,
         1090,  8926, 16224,  1013,   262,  8425,   261,   311,   265,   349,
          303,   266,  2553,  1013,   260,  1414,   273,   338,  3753,   288,
         4136,   273,   338,   472,   264,   687,   308,   645,   401,   273,
         1331,   308,   645,   284,   397,   324,  1964,   273, 40756,   834,
        31452,   278,   322,   263,   262,   645,  1127,   324, 12516,   263,
         7741,   260,   273,   338,   327,   472,   264,  2224,   277,   266,
         2750,   263,  5771,   390,   262,   707,   260,     2])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_ids</span><span class="o">=</span><span class="n">enc_ds_d</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">][</span><span class="s1">&#39;input_ids&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="n">enc_ds_d</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">outputs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SequenceClassifierOutput(loss=tensor(0.6910, grad_fn=&lt;BinaryCrossEntropyWithLogitsBackward0&gt;), logits=tensor([[ 0.1523,  0.1020,  0.0271, -0.0094, -0.0423,  0.1312, -0.1664,  0.2214,
          0.1243,  0.0934, -0.0382, -0.1368, -0.1676,  0.0055, -0.2820, -0.0138,
          0.1081, -0.1334, -0.1276, -0.0073,  0.0665,  0.3525, -0.2512,  0.1544,
          0.1957,  0.2246,  0.1495, -0.0065, -0.1206, -0.0391,  0.0098,  0.0422,
         -0.1200,  0.1003, -0.0925, -0.0526,  0.0683, -0.2110,  0.0239,  0.1355,
          0.2869,  0.0020, -0.1044, -0.4394,  0.2157, -0.1819,  0.0900, -0.0036,
         -0.0499, -0.2271,  0.0909, -0.1022, -0.1857,  0.1304]],
       grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="n">args</span><span class="p">,</span>
    <span class="n">train_dataset</span><span class="o">=</span><span class="n">enc_ds_d</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">],</span>
    <span class="n">eval_dataset</span><span class="o">=</span><span class="n">enc_ds_d</span><span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">],</span>
    <span class="n">tokenizer</span><span class="o">=</span><span class="n">tokz</span><span class="p">,</span>
    <span class="n">compute_metrics</span><span class="o">=</span><span class="n">compute_metrics</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trainer</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.9/dist-packages/transformers/optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
***** Running training *****
  Num examples = 2933
  Num Epochs = 5
  Instantaneous batch size per device = 8
  Total train batch size (w. parallel, distributed &amp; accumulation) = 8
  Gradient Accumulation steps = 1
  Total optimization steps = 1835
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
      
      <progress value="1835" max="1835" style="width:300px; height:20px; vertical-align: middle;"></progress>
      [1835/1835 06:54, Epoch 5/5]
    </div>
    <table border="1" class="dataframe">
  <thead>
 <tr style="text-align: left;">
      <th>Epoch</th>
      <th>Training Loss</th>
      <th>Validation Loss</th>
      <th>Mcrmse</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>No log</td>
      <td>0.285186</td>
      <td>0.276595</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.294300</td>
      <td>0.262396</td>
      <td>0.277009</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.256900</td>
      <td>0.258025</td>
      <td>0.276918</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.256900</td>
      <td>0.264292</td>
      <td>0.277865</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.237500</td>
      <td>0.268947</td>
      <td>0.280089</td>
    </tr>
  </tbody>
</table><p>
&lt;/div&gt;

&lt;/div&gt;

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>***** Running Evaluation *****
  Num examples = 978
  Batch size = 8
Saving model checkpoint to outputs/checkpoint-367
Configuration saved in outputs/checkpoint-367/config.json
Model weights saved in outputs/checkpoint-367/pytorch_model.bin
tokenizer config file saved in outputs/checkpoint-367/tokenizer_config.json
Special tokens file saved in outputs/checkpoint-367/special_tokens_map.json
***** Running Evaluation *****
  Num examples = 978
  Batch size = 8
Saving model checkpoint to outputs/checkpoint-734
Configuration saved in outputs/checkpoint-734/config.json
Model weights saved in outputs/checkpoint-734/pytorch_model.bin
tokenizer config file saved in outputs/checkpoint-734/tokenizer_config.json
Special tokens file saved in outputs/checkpoint-734/special_tokens_map.json
***** Running Evaluation *****
  Num examples = 978
  Batch size = 8
Saving model checkpoint to outputs/checkpoint-1101
Configuration saved in outputs/checkpoint-1101/config.json
Model weights saved in outputs/checkpoint-1101/pytorch_model.bin
tokenizer config file saved in outputs/checkpoint-1101/tokenizer_config.json
Special tokens file saved in outputs/checkpoint-1101/special_tokens_map.json
***** Running Evaluation *****
  Num examples = 978
  Batch size = 8
Saving model checkpoint to outputs/checkpoint-1468
Configuration saved in outputs/checkpoint-1468/config.json
Model weights saved in outputs/checkpoint-1468/pytorch_model.bin
tokenizer config file saved in outputs/checkpoint-1468/tokenizer_config.json
Special tokens file saved in outputs/checkpoint-1468/special_tokens_map.json
***** Running Evaluation *****
  Num examples = 978
  Batch size = 8
Saving model checkpoint to outputs/checkpoint-1835
Configuration saved in outputs/checkpoint-1835/config.json
Model weights saved in outputs/checkpoint-1835/pytorch_model.bin
tokenizer config file saved in outputs/checkpoint-1835/tokenizer_config.json
Special tokens file saved in outputs/checkpoint-1835/special_tokens_map.json


Training completed. Do not forget to share your model on huggingface.co/models =)


Loading best model from outputs/checkpoint-1835 (score: 0.2800890973793673).
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>TrainOutput(global_step=1835, training_loss=0.2556868800025545, metrics={&#39;train_runtime&#39;: 414.8279, &#39;train_samples_per_second&#39;: 35.352, &#39;train_steps_per_second&#39;: 4.424, &#39;total_flos&#39;: 486126273507840.0, &#39;train_loss&#39;: 0.2556868800025545, &#39;epoch&#39;: 5.0})</pre>
</div>

</div>

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Predict">Predict<a class="anchor-link" href="#Predict"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Set up dataset</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">tok_func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">tokz</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;full_text&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds_tst</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df_tst</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">eval_ds</span> <span class="o">=</span> <span class="n">ds_tst</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">tok_func</span><span class="p">,</span> <span class="n">batched</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;text_id&quot;</span><span class="p">,</span><span class="s2">&quot;full_text&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>An example for a text in the test set.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds_tst</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;full_text&quot;</span><span class="p">][:</span><span class="mi">30</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;when a person has no experienc&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="n">ds_tst</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;full_text&quot;</span><span class="p">]</span>
<span class="n">encoding</span> <span class="o">=</span> <span class="n">tokz</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">return_tensors</span><span class="o">=</span><span class="s2">&quot;pt&quot;</span><span class="p">)</span>
<span class="n">encoding</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">trainer</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">device</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">encoding</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

<span class="n">outputs</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">encoding</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Lets convert the model outputs to probabilities!</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">logits</span> <span class="o">=</span> <span class="n">outputs</span><span class="o">.</span><span class="n">logits</span>
<span class="n">logits</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([1, 54])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sigmoid</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Sigmoid</span><span class="p">()</span>
<span class="n">probs</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">logits</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In each column the probability for each grade in category!</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">probs_cat</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">probs</span><span class="p">,(</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="n">probs_cat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[1.3449e-03, 4.0534e-03, 1.9329e-01, 4.4354e-01, 2.9212e-01, 5.5185e-02,
         4.2550e-03, 9.5515e-04, 2.5638e-04],
        [8.3035e-04, 4.3410e-03, 2.6706e-01, 5.0903e-01, 2.1249e-01, 1.7460e-02,
         2.2924e-03, 3.5820e-04, 1.7877e-04],
        [3.1327e-04, 1.2887e-03, 4.9035e-02, 3.4472e-01, 5.9424e-01, 3.5466e-02,
         5.9954e-03, 6.2657e-04, 3.3844e-04],
        [1.1110e-03, 1.2210e-03, 2.2265e-01, 4.9241e-01, 2.9399e-01, 2.3312e-02,
         4.7664e-03, 6.3960e-04, 3.5847e-04],
        [7.9150e-04, 3.1421e-03, 3.5284e-01, 4.5543e-01, 1.6734e-01, 2.3337e-02,
         3.6956e-03, 4.7873e-04, 3.8009e-04],
        [1.8744e-03, 2.8594e-03, 2.6097e-01, 4.9264e-01, 1.8876e-01, 3.0931e-02,
         2.9663e-03, 5.4795e-04, 3.0063e-04]], grad_fn=&lt;ReshapeAliasBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Find for each category the predicted grade!</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pred</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">probs_cat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pred</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([3, 3, 4, 3, 3, 3])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predicted_labels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pred</span><span class="p">]</span>
<span class="n">predicted_labels</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[2.5, 2.5, 3.0, 2.5, 2.5, 2.5]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">eval_ds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>***** Running Prediction *****
  Num examples = 3
  Batch size = 8
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
      
      <progress value="1" max="1" style="width:300px; height:20px; vertical-align: middle;"></progress>
      [1/1 : &lt; :]
    </div>
    
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds_tt</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">predictions</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sigmoid</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Sigmoid</span><span class="p">()</span>
<span class="n">probs</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">preds_tt</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">probs</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([3, 54])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">probs_cat</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">probs</span><span class="p">,(</span><span class="n">eval_ds</span><span class="o">.</span><span class="n">num_rows</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="n">probs_cat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[[1.3449e-03, 4.0534e-03, 1.9329e-01, 4.4354e-01, 2.9212e-01,
          5.5185e-02, 4.2550e-03, 9.5515e-04, 2.5638e-04],
         [8.3035e-04, 4.3410e-03, 2.6706e-01, 5.0903e-01, 2.1249e-01,
          1.7460e-02, 2.2924e-03, 3.5820e-04, 1.7877e-04],
         [3.1327e-04, 1.2887e-03, 4.9035e-02, 3.4472e-01, 5.9424e-01,
          3.5466e-02, 5.9954e-03, 6.2657e-04, 3.3844e-04],
         [1.1110e-03, 1.2210e-03, 2.2265e-01, 4.9241e-01, 2.9399e-01,
          2.3312e-02, 4.7664e-03, 6.3960e-04, 3.5847e-04],
         [7.9150e-04, 3.1421e-03, 3.5284e-01, 4.5543e-01, 1.6734e-01,
          2.3337e-02, 3.6956e-03, 4.7873e-04, 3.8009e-04],
         [1.8744e-03, 2.8594e-03, 2.6097e-01, 4.9264e-01, 1.8876e-01,
          3.0931e-02, 2.9663e-03, 5.4795e-04, 3.0063e-04]],

        [[6.9702e-04, 2.2156e-03, 1.3525e-01, 4.0190e-01, 3.5979e-01,
          8.3393e-02, 6.3948e-03, 8.6993e-04, 2.2647e-04],
         [4.6869e-04, 2.0869e-03, 1.7277e-01, 5.0589e-01, 2.9519e-01,
          2.7507e-02, 3.1139e-03, 3.2655e-04, 1.5393e-04],
         [1.7464e-04, 7.4361e-04, 2.6913e-02, 2.8327e-01, 6.5481e-01,
          5.2866e-02, 8.4536e-03, 6.0302e-04, 2.9023e-04],
         [5.6700e-04, 7.7239e-04, 1.4403e-01, 4.4338e-01, 3.8536e-01,
          3.7247e-02, 6.1888e-03, 6.0653e-04, 3.1055e-04],
         [4.2745e-04, 1.7662e-03, 2.5455e-01, 4.5494e-01, 2.3762e-01,
          3.6414e-02, 5.2301e-03, 4.7578e-04, 3.3699e-04],
         [9.9297e-04, 1.4795e-03, 1.5690e-01, 4.7478e-01, 2.8432e-01,
          5.2038e-02, 4.1617e-03, 5.1195e-04, 2.6572e-04]],

        [[8.9919e-05, 2.2792e-04, 1.0313e-02, 9.4493e-02, 3.4430e-01,
          4.0744e-01, 1.2611e-01, 4.3038e-03, 1.0102e-03],
         [7.9191e-05, 1.3719e-04, 1.1439e-02, 7.6456e-02, 5.0715e-01,
          3.4287e-01, 5.0529e-02, 2.9594e-03, 5.8506e-04],
         [5.5959e-05, 1.3887e-04, 1.4530e-03, 2.7991e-02, 4.2644e-01,
          4.2822e-01, 1.2768e-01, 4.4846e-03, 1.3150e-03],
         [8.3560e-05, 1.8322e-04, 8.9937e-03, 6.9328e-02, 4.2182e-01,
          3.8917e-01, 8.6680e-02, 3.8928e-03, 1.0506e-03],
         [7.3068e-05, 2.1460e-04, 1.5649e-02, 1.3015e-01, 3.8366e-01,
          3.6370e-01, 8.9219e-02, 3.5911e-03, 1.2481e-03],
         [9.8681e-05, 1.5562e-04, 4.8098e-03, 6.4202e-02, 4.5954e-01,
          3.9083e-01, 8.0475e-02, 5.0407e-03, 1.0509e-03]]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pred</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">probs_cat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pred</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[3, 3, 4, 3, 3, 3],
        [3, 3, 4, 3, 3, 3],
        [5, 4, 5, 4, 4, 4]])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we get prediction for the i'th column that means we have have for the category given by the row index</p>
<p>$grad_{cat} = i * 0.5 + 1$</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">grades</span> <span class="o">=</span> <span class="n">pred</span><span class="o">*</span><span class="mf">0.5</span><span class="o">+</span><span class="mi">1</span>
<span class="n">grades</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[2.5000, 2.5000, 3.0000, 2.5000, 2.5000, 2.5000],
        [2.5000, 2.5000, 3.0000, 2.5000, 2.5000, 2.5000],
        [3.5000, 3.0000, 3.5000, 3.0000, 3.0000, 3.0000]])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's convert this to a dataframe:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sub</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">grades</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="n">sub</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df_ss</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">sub</span><span class="p">[</span><span class="s2">&quot;text_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_tst</span><span class="p">[</span><span class="s2">&quot;text_id&quot;</span><span class="p">]</span>
<span class="n">sub</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cohesion</th>
      <th>syntax</th>
      <th>vocabulary</th>
      <th>phraseology</th>
      <th>grammar</th>
      <th>conventions</th>
      <th>text_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.5</td>
      <td>2.5</td>
      <td>3.0</td>
      <td>2.5</td>
      <td>2.5</td>
      <td>2.5</td>
      <td>0000C359D63E</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.5</td>
      <td>2.5</td>
      <td>3.0</td>
      <td>2.5</td>
      <td>2.5</td>
      <td>2.5</td>
      <td>000BAD50D026</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.5</td>
      <td>3.0</td>
      <td>3.5</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>00367BB2546B</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_ss</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text_id</th>
      <th>cohesion</th>
      <th>syntax</th>
      <th>vocabulary</th>
      <th>phraseology</th>
      <th>grammar</th>
      <th>conventions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0000C359D63E</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>000BAD50D026</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>00367BB2546B</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We need to rearrange the columns to get the right format.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sub</span> <span class="o">=</span> <span class="n">sub</span><span class="p">[</span><span class="n">df_ss</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="n">sub</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text_id</th>
      <th>cohesion</th>
      <th>syntax</th>
      <th>vocabulary</th>
      <th>phraseology</th>
      <th>grammar</th>
      <th>conventions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0000C359D63E</td>
      <td>2.5</td>
      <td>2.5</td>
      <td>3.0</td>
      <td>2.5</td>
      <td>2.5</td>
      <td>2.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>000BAD50D026</td>
      <td>2.5</td>
      <td>2.5</td>
      <td>3.0</td>
      <td>2.5</td>
      <td>2.5</td>
      <td>2.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>00367BB2546B</td>
      <td>3.5</td>
      <td>3.0</td>
      <td>3.5</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

&lt;/div&gt;
 

</p></div></div></div></div></div></div>


  </div><a class="u-url" href="/ai_blog/2022/09/05/First-try-with-Hugging-Face.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/ai_blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/ai_blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/ai_blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/fastai" target="_blank" title="fastai"><svg class="svg-icon grey"><use xlink:href="/ai_blog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" target="_blank" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/ai_blog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
